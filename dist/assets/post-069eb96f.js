import{d as D,r as c,S as w,a as u,o as T,h as L,i as o,e as t,b as _,O as i,z as R,c as B}from"./index-f83309f8.js";import{u as F}from"./useHandleData-6b7335ab.js";import{i as M,j as h,k as A,l as H,m as N}from"./index-54c3d6fd.js";import"./index-2a3f9cb3.js";const j=D({__name:"PostDialog",setup(S,{expose:V}){let s=c({});const P=w({name:[{required:!0,message:"请填写岗位名称"}],postCode:[{required:!0,message:"请填写岗位编码"}],description:[{required:!0,message:"请填写岗位描述"}]}),d=c(!1),b=c(),v=c(!1),C=c(),l=a=>{const e=a.rowData;s.value=e,b.value=n(a),C.value=a,d.value=!0},n=a=>{var e;return(e=a.rowData)!=null&&e.id?"编辑":"新增"},p=c(),g=a=>{a&&a.validate(async e=>{var y,f;if(e)try{v.value=!0,await((y=C.value)==null?void 0:y.api(s.value)),R.success({message:`${b.value}成功！`}),(f=C.value)==null||f.getTableList(),d.value=!1,v.value=!1,m(a)}catch(k){v.value=!1,console.log(k)}})},m=a=>{a&&a.resetFields()};return V({acceptParams:l}),(a,e)=>{const y=u("el-input"),f=u("el-form-item"),k=u("el-radio"),$=u("el-radio-group"),U=u("el-form"),x=u("el-button"),q=u("el-dialog");return T(),L(q,{modelValue:d.value,"onUpdate:modelValue":e[6]||(e[6]=r=>d.value=r),title:b.value,"destroy-on-close":!0,width:"500px"},{footer:o(()=>[t(x,{onClick:e[4]||(e[4]=r=>d.value=!1)},{default:o(()=>[_("取消")]),_:1}),t(x,{type:"primary",onClick:e[5]||(e[5]=r=>g(p.value)),loading:v.value},{default:o(()=>[_(" 确定 ")]),_:1},8,["loading"])]),default:o(()=>[t(U,{ref_key:"ruleFormRef",ref:p,"label-width":"100px","label-suffix":" :",rules:P,model:i(s)},{default:o(()=>[t(f,{label:"岗位名称",prop:"name"},{default:o(()=>[t(y,{modelValue:i(s).name,"onUpdate:modelValue":e[0]||(e[0]=r=>i(s).name=r),modelModifiers:{trim:!0},placeholder:"请填写岗位名称",clearable:""},null,8,["modelValue"])]),_:1}),t(f,{label:"岗位编码",prop:"postCode"},{default:o(()=>[t(y,{modelValue:i(s).postCode,"onUpdate:modelValue":e[1]||(e[1]=r=>i(s).postCode=r),modelModifiers:{trim:!0},placeholder:"请填写岗位编码",clearable:""},null,8,["modelValue"])]),_:1}),t(f,{label:"岗位描述",prop:"description"},{default:o(()=>[t(y,{modelValue:i(s).description,"onUpdate:modelValue":e[2]||(e[2]=r=>i(s).description=r),modelModifiers:{trim:!0},placeholder:"请填写岗位描述",clearable:"",type:"textarea"},null,8,["modelValue"])]),_:1}),t(f,{label:"状态",prop:"status"},{default:o(()=>[t($,{modelValue:i(s).status,"onUpdate:modelValue":e[3]||(e[3]=r=>i(s).status=r)},{default:o(()=>[t(k,{label:1},{default:o(()=>[_("正常")]),_:1}),t(k,{label:0},{default:o(()=>[_("停用")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])}}}),G=D({__name:"post",setup(S){const V=c(),s=w({}),P=l=>({list:l==null?void 0:l.records,total:l==null?void 0:l.total}),d=c(),b=(l,n={})=>{var m;let p={postCode:"",name:"",description:"",status:1,id:""};const g={rowData:l==0?{...n,...p}:{...n},api:l==0?h:A,getTableList:(m=V.value)==null?void 0:m.getTableList};console.log("params",g),d.value.acceptParams(g)},v=async l=>{var n;await F(H,l.id,`删除${l.name}`),(n=V.value)==null||n.getTableList()},C=[{type:"index",label:"序号",width:80},{prop:"name",label:"岗位名称"},{prop:"postCode",label:"岗位编码"},{prop:"description",label:"岗位描述"},{prop:"status",label:"状态",width:100,enum:[{label:"正常",value:1},{label:"停用",value:0}],render:({row:l})=>t(u("el-switch"),{"active-value":1,"inactive-value":0,modelValue:l.status,"onUpdate:modelValue":n=>l.status=n,onChange:()=>N(l.id,l.status)},null)},{prop:"operation",label:"操作",fixed:"right",width:280}];return(l,n)=>{const p=u("el-button"),g=u("ProTable");return T(),B("div",null,[t(g,{ref_key:"proTable",ref:V,dataCallback:P,columns:C,requestApi:i(M),initParam:s},{tableHeader:o(()=>[t(p,{type:"primary",icon:"Plus",onClick:n[0]||(n[0]=m=>b(0))},{default:o(()=>[_(" 添加 ")]),_:1})]),operation:o(m=>[t(p,{type:"primary",link:"",icon:"Edit",onClick:a=>b(1,m.row)},{default:o(()=>[_(" 编辑 ")]),_:2},1032,["onClick"]),t(p,{type:"primary",link:"",icon:"Delete",onClick:a=>v(m.row)},{default:o(()=>[_(" 删除 ")]),_:2},1032,["onClick"])]),_:1},8,["requestApi","initParam"]),t(j,{ref_key:"DialogRef",ref:d},null,512)])}}});export{G as default};
